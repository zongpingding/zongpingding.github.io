

<!DOCTYPE html>
<html lang="en" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/fluid_theme_pic/favicon.png">
  <link rel="icon" href="/fluid_theme_pic/favicon.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="author" content="Eureka">
  <meta name="keywords" content="">
  
    <meta name="description" content="1. 敬告 这是一个过来人的真实经历. 我为什么要用 Linux ? 也许是因为 Linux 的自定义程度高吧, 而且在折腾的过程中也能学到一点东西，从此我也很喜欢上了 Linux 的命令行, 以前觉得那些使用命令行的人太傻了，放着好好的 GUI 界面不去用. 现在看来，其实二者各有千秋, 命令行下其实常用命令就那几个, 慢慢积累的,不用的就去查. 部分情况下也许是命令行比较高效, 但是既然 GU">
<meta property="og:type" content="article">
<meta property="og:title" content="ArchLinux 入门">
<meta property="og:url" content="https://zongpingding.github.io/2024/03/26/archlinux_intro/index.html">
<meta property="og:site_name" content="Eureka">
<meta property="og:description" content="1. 敬告 这是一个过来人的真实经历. 我为什么要用 Linux ? 也许是因为 Linux 的自定义程度高吧, 而且在折腾的过程中也能学到一点东西，从此我也很喜欢上了 Linux 的命令行, 以前觉得那些使用命令行的人太傻了，放着好好的 GUI 界面不去用. 现在看来，其实二者各有千秋, 命令行下其实常用命令就那几个, 慢慢积累的,不用的就去查. 部分情况下也许是命令行比较高效, 但是既然 GU">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://zongpingding.github.io/img/archlinux_intro/banner.webp">
<meta property="article:published_time" content="2024-03-26T09:15:50.120Z">
<meta property="article:modified_time" content="2024-07-29T09:26:26.364Z">
<meta property="article:author" content="Eureka">
<meta property="article:tag" content="Computer">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://zongpingding.github.io/img/archlinux_intro/banner.webp">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>ArchLinux 入门 - Eureka</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  




  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"zongpingding.github.io","root":"/","version":"1.9.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"left","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":{"measurement_id":null},"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml","include_content_in_search":true};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  


  
<meta name="generator" content="Hexo 7.0.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>Place of Eureka</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/" target="_self">
                <i class="iconfont icon-home-fill"></i>
                <span>Home</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/" target="_self">
                <i class="iconfont icon-archive-fill"></i>
                <span>Archives</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/" target="_self">
                <i class="iconfont icon-category-fill"></i>
                <span>Categories</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/" target="_self">
                <i class="iconfont icon-tags-fill"></i>
                <span>Tags</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item dropdown">
              <a class="nav-link dropdown-toggle" target="_self" href="javascript:;" role="button"
                 data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                <i class="iconfont icon-th-large"></i>
                <span>Optional</span>
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdown">
                
                  
                  
                  
                  <a class="dropdown-item" href="/about/" target="_self">
                    <i class="iconfont icon-user-fill"></i>
                    <span>About</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/links/" target="_self">
                    <i class="iconfont icon-link-fill"></i>
                    <span>Links</span>
                  </a>
                
                  
                  
                  
                  <a class="dropdown-item" href="/opt/24game/" target="_self">
                    <i class="iconfont icon-switch-fill"></i>
                    <span>24game</span>
                  </a>
                
              </div>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/img/archlinux_intro/banner.webp') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="ArchLinux 入门"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2024-03-26 17:15" pubdate>
          March 26, 2024 pm
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          13k words
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          107 mins
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <h1 id="seo-header">ArchLinux 入门</h1>
            
            
              <div class="markdown-body">
                
                <h2 id="1-敬告">1. 敬告</h2>
<p>这是一个过来人的真实经历. 我为什么要用 Linux ? 也许是因为 Linux 的自定义程度高吧, 而且在折腾的过程中也能学到一点东西，从此我也很喜欢上了 Linux 的命令行, 以前觉得那些使用命令行的人太傻了，放着好好的 GUI 界面不去用. 现在看来，其实二者各有千秋, 命令行下其实常用命令就那几个, 慢慢积累的,不用的就去查. 部分情况下也许是命令行比较高效, 但是既然 GUI 用户占大多数，说明 GUI 这个理念也迎合了很多的人.</p>
<p>在使用 Linux 一段时间后, 我的 Windows 也被我调教的挺好的, 而且我也不是那么排斥 Windows, 所以目前打算就这样用着. 入坑 Arch 需谨慎, 你要有那种 “一个人, 一支烟, 一bug一整天” 的精神. 不然的话, 你还是乖乖用 Windows 吧, 但是你一旦度过这个最艰难的时期你就会觉得,也就这样吧。不管怎样, 祝各位 Archlinux 用户都有一个愉快的使用体验, 祝天天滚挂 &gt;_&lt;.</p>
<p>其次记住, Linux 它不是 windows; windows 也不是 Linux; 所以你不应该用 windows 的要求去要求 Linux, 同样用 Linux 的要求去要求 windows也是不合理的。最后, Linux也好, windows也好, 它们都只是一个工具而已, 是为了给我们提供服务, 所以什么适合自己就用什么吧.</p>
<h2 id="2-阅前提醒">2. 阅前提醒</h2>
<p>文章很长, 我想在这里把我个人的所有关于 Linux 感受说出来, 特别是对于 Arch. 我并不想你浪费时间来阅读一个你不感兴趣的内容, 所以不感兴趣可以关闭这个网页了. 好了, 正文开始！想要看 Archlinux 安装的请直接跳到 <strong>[第6节]</strong></p>
<h2 id="3-此文目的">3. 此文目的</h2>
<p>此篇文章的目的: 记录我使用Linux的经历, 至少以后还能留下一些东西. 因为我现在发现我那种折腾的耐心了, 可以这样说. 反正我感觉我每天都在和Linux斗智斗勇, 几乎每个软件都有bug。我甚至都不知道我为什么最初会选择Linux, 我好像忘记了我选择 Linux 的初衷.现在每天折腾Linux都很痛苦, 仿佛以前的那种折腾Linux的快乐再也没有了, 以前的我是那么的乐此不疲。希望我把这篇文章写完之后, 回忆起当初使用 Linux 的种种, 能够找到属于 Linux 的那份快乐, 不然我可能真的要放弃 Linux 了</p>
<ul>
<li>但是Linux本来就是你爱用不用的</li>
<li>这里没有其他的意思, 其实我还是挺想用Linux的</li>
</ul>
<h2 id="4-Where-to-learn">4. Where to learn ?</h2>
<ol>
<li>
<p>首先是去小破站（B站）, 众所周知, 小破站是最大的学习网站</p>
</li>
<li>
<p>其次当然是去官方的Arch wiki或者是在Arch的bug里边看看是不是系统本身的原因, 抑或是Arch的Fomular</p>
</li>
<li>
<p>然后就是先查百度, 看有没有人的经历和我相同, 这样改Bug就快得多.因为百度还会展示以下的这些网站里边的相关的内容。</p>
<blockquote>
<p>有时候我觉得百度的搜索结果还是挺好的</p>
</blockquote>
</li>
<li>
<p>百度的方法不行, 就上知乎, 看看有没有类似的经历</p>
</li>
<li>
<p>知乎不行, 就上csdn</p>
<blockquote>
<p>虽然很多人都说这里是一个垃圾堆, 但是我觉得那是对于那种高手而言的；我虽然没有经常逛, 但毕竟这是我第一个接触到的编程相关的网站, 还是它把握领进门的吧。但是现在我也觉得csdn的做法有一点的恶心了, 唉……</p>
</blockquote>
</li>
<li>
<p>csdn不行, 我就会上老牌社区博客园看看</p>
<blockquote>
<p>现在我觉得博客园很好, 很清爽, 很干净, 社区氛围很好, 力荐</p>
</blockquote>
</li>
<li>
<p>博客园还不行的话我就只有上github了, 毕竟我的英语并不是很好, 虽然有浏览器的翻译, 但你们有没有觉得有时候浏览器的翻译怪怪的, 我从Arch wiki得出的经验</p>
</li>
<li>
<p>实在是没有办法了就只有上国外的网站搜索了。比如Quora, Stack Overflow, Stack Exchange, 或者是一些民间社区。 但是你得英语好, 再者就是盲目的google了</p>
</li>
<li>
<p>最后一招:也是我的杀手鐗: remake。软件卸载了然后重装。</p>
</li>
</ol>
<h2 id="5-How-to-learn">5. How to learn ?</h2>
<p>很多人可能都会认为上边的内容过于的浮夸, 但是我觉得，从一个电脑小白到安装手动 Linux 的路还是比较长的. 也许你需要去了解磁盘的分区方式, Linux 的文件系统, 挂载的概念, 文件系统的 inode, 以及 block 等东西。</p>
<blockquote>
<p>特别感谢在 2023 年寒假一直陪伴我的: <a target="_blank" rel="noopener" href="https://linux.vbird.org/">鳥哥的 Linux 私房菜</a>. 尽管 <code>服务器假设篇</code> 那本书我几乎没怎么看，但是 <code>基础篇</code> 我几乎看完了, 部分内容至今仍觉得历历在目 …</p>
</blockquote>
<p>因为我是准备安装 Windows + Linux 双系统, 然而原本的 win10 里边还有很多的重要文件, 课件, 包括一些难以安装的工业软件等。我不想到时候 archlinux 没有安装成功, 反而把原本的 win10 也搞挂了。所以即使是网上有很详细的双系统安装教程, 我也不敢一步一步的照着做。我还是得去查询每一条命令的实际作用, 查询这个命令运行后对原本文件系统的影响。</p>
<p>也许不会相信我所说的, 可能觉得太过夸张了。但是我当时连:</p>
<ul>
<li>linux 命令行</li>
<li>GPT,  MBR</li>
<li>BIOS, UEFI</li>
<li>GRUB</li>
</ul>
<p>这些东西都没有听说过, 更不用说知道它们是干什么的. 特别是在目睹了网上很多老鸟安装双系统后失败的惨状, 作为一个电脑小白, 我害怕极了. 我不会放开手去按照网上的教程安装，所以我的解决办法是:</p>
<ul>
<li>先去小破站把上边所说的什么: linux命令行, GPT,  MBR,  BIOS,  UEFI, GRUB 了解一下</li>
<li>然后在小破站看看装机视频(就是单纯安装 windows 的, 听听那些 up 对于每一步操作的解释, 在这里推荐up: <code>硬件茶谈</code>, 他的视频解决了我在这一阶段的大部分问题)</li>
<li>不实际操作, 总是会感觉不踏实: 但只有一个实体机, 怎么做实验呢? 对了, 使用虚拟机。我用的是 VMware。为了练习安装操作系统，我的 Vmware的系统快照最终变成了一个 “树” 形图，现在还是那些操作失败的系统安装分支都被删除的样子:</li>
</ul>
<p><img src="/img/archlinux_intro/os_shoots_1.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p><img src="/img/archlinux_intro/os_shoots_2.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>这些系统快照在容积最大的时候, 占了我大约 200G 的磁盘, 接下来就是实体机的安装了</p>
<h2 id="6-安装教程">6. 安装教程</h2>
<p>在虚拟机上进行演练后, 我自信满满的</p>
<ul>
<li>在我的硬盘分出一个区</li>
<li>安装基础包</li>
<li>编写基本配置</li>
<li>安装 DWM</li>
</ul>
<p>虽然最终是安装好了，但是, 我还是想要记录下我这个过程中经理的种种 …</p>
<h3 id="6-1-制作启动盘">6.1 制作启动盘</h3>
<p>我使用的是 rufus,一个免费的软件, 在windows上制作的, 具体的注意点:</p>
<ul>
<li>选项 --&gt; GPT</li>
<li>写入方式 --&gt; DD</li>
</ul>
<p>关于选项设置, 对于自己的电脑的启动方式, 可以在 Windows 上的 <code>运行</code> 框中输入:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">msinfo32<br></code></pre></td></tr></table></figure>
<p>来查看, 如果 <code>BIOS MODE</code> 显示的是 <code>UEFI</code> 那么就选择 <code>GPT</code>, 如果是 <code>Legacy</code> 那么就选择 <code>MBR</code>.进入LiveCD, HONOR 笔记本开机时长按的两个按键的说明:</p>
<ul>
<li>F2: 设置 BIOS</li>
<li>F12: 选择启动项</li>
</ul>
<h3 id="6-1-连接网络">6.1 连接网络</h3>
<p>要在实体机中安装 Arch, 你首先的连的上网, 来下载 Arch 的基本环境组件(固件, 驱动, 内核等等).首先, 在虚拟机中我是使用的NAT来让我的虚拟机链接上网络的, 但那是在实体机里边怎么搞呢? 其实挺简单的；假如你想使用无线网的话, 依次输入如下命令即可</p>
<div class="note note-warning">
            <p>备注: 在后文中,  <code>#</code> 后边的内容代表注释</p>
          </div>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">iwctl                                               # 进入iwd模式<br>device list                                         # 扫描你的无线网卡<br>station &lt;your netcard name&gt; scan                    # 使用你的网卡扫描周围的可用wifi<br>station &lt;your netcard name&gt; get-networks            # 列出刚才扫描到的wifi的名称<br>station &lt;your netcard name&gt; connect &lt;wifi name&gt;     # 他会自动要求你输入密码（不会显示你键入的字符, 但是你的确时输入进去了, 键入完成后 摁 &lt;Enter&gt;即可）<br>exit                                                # 退出iwd模式[重要]；别在iwd模式下运行下边的命令, 不然你会得到 &quot;command not found&quot;<br></code></pre></td></tr></table></figure>
<p>但是, 我还是推荐第二种联网方案的,就是直接利用DHCP.简单来说就是直接从你的路由器</p>
<blockquote>
<p>要可以上网的, 别用那种电都没插的, 或者是其他的离谱路由器</p>
</blockquote>
<p>上接一根网线出来连接到你的电脑上。(USB口的可以买一个转接器)然后你的电脑自动就能够上网了, 不用你设置什么的。为什么我推荐这种方式呢?</p>
<ol>
<li>稳定: 如果安装的过中, 隔壁的老王利用你的wifi偷看“学习资料”, 或者是各种原因导致你的wifi不稳定</li>
<li>速度快:  同样也是为了防火,  防电, 防老王。这样你的安装会很快(应该可以减少焦虑吧)</li>
</ol>
<blockquote>
<p>我就是用的DHCP, 网速平均能够达到30mb/s左右</p>
</blockquote>
<p>首先, 因为在虚拟机的时候我可以手动选择启动时进入BIOS界面。怎么检测你是否连接上互联网了呢?<br>
连接一下网站试试呗,运行如下的命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ping www.baidu.com    # www.可以不加；(如果不断地返回了 64bytes from …… 之类的字眼, 说明联网成功)<br></code></pre></td></tr></table></figure>
<h3 id="6-2-refleactor-服务">6.2 refleactor 服务</h3>
<p>系统里边又一个名为 <code>refleactor</code> 的服务, 它会挑选一下我们下载软件的仓库地址, 然后把它们放到</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">/etc/pacman.d/mirrorlist    <br><span class="hljs-meta prompt_"># </span><span class="language-bash">在Linux中没有C,  D盘之类的概念。你可以认为它只有一个文件夹,这个文夹的名字叫<span class="hljs-string">&quot;/&quot;</span>.你之后的所有东西都放在这个文件夹里边</span><br></code></pre></td></tr></table></figure>
<p>的文件下, 这个文件夹的大概结构图示（扩容的问题:  很简单的, 后边会讲）</p>
<p><img src="/img/archlinux_intro/file_system.png" srcset="/img/loading.gif" lazyload alt="来源: 菜鸟教程(侵权删)"></p>
<p>为什么要禁用reflector ?</p>
<blockquote>
<p>你想, 它同步的是全球的下载源（地址）, 什么自由美利坚啊, 加拿大啊之类的, 当然也有我们中国的。 但是我们下载&lt;东西&gt;的时候时好像是默认使用排在前边的几个地址。你想, 你从美国下载快,  还是中国快。</p>
</blockquote>
<p>所以我们就可以添加几个中国的源(下载地址)到开头: (再次提醒: <code>#</code> 后边的内容是注释)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">Server = https://mirrors.ustc.edu.cn/archlinux/$repo/os/$arch                # 中国科学技术大学开源镜像站<br>Server = https://mirrors.tuna.tsinghua.edu.cn/archlinux/$repo/os/$arch       # 清华大学开源软件镜像站<br>Server = https://repo.huaweicloud.com/archlinux/$repo/os/$arch               # 华为开源镜像站<br>Server = http://mirror.lzu.edu.cn/archlinux/$repo/os/$arch                   # 兰州大学开源镜像站<br></code></pre></td></tr></table></figure>
<p>怎么添加呢?挺简单地（你会vim的基础操作情况下）</p>
<h3 id="ref-vim-基础操作">ref: vim 基础操作</h3>
<ol>
<li>怎么退出 vim ? 没想到吧, 你第一次接触 vim 你可能都无法退出这个东西</li>
</ol>
<ul>
<li>先按个几下 <code>&lt;Esc&gt;</code> 键,看到 vim 的左下角出现 normal mode 或者是 Insert mode 消失</li>
<li>在英文模式下输入 <code>:wq</code> 即可,但是这个是保存后退出</li>
<li>不保存强制退出就输入 <code>:q!</code></li>
</ul>
<ol start="2">
<li>怎么插入文本, 或者说怎么使用“人性化”的方法进行类似 notepad 的操作</li>
</ol>
<ul>
<li>在 <code>normal mode</code> 的情况下, 在英文输入的情况下, 键入 <code>a i o</code> 中任何一个字母即可</li>
<li>然后用上下左右方向 <code>(k j h l)</code> 键进行光标的移动</li>
</ul>
<ol start="3">
<li>复制粘贴</li>
</ol>
<ul>
<li>在 normal 模式下使用 <code>&lt;n&gt;yy</code> 可以实现复制 n 行, 然后用 p 粘贴</li>
<li>部分的 vim 支持系统的剪切板, 输入 <code>echo has('clipboard')</code> 即可验证</li>
</ul>
<ol start="4">
<li>搜索</li>
</ol>
<ul>
<li>在normal模式下输入 <code>:/&lt;text you find&gt;</code></li>
<li>搜索支持正则表达式</li>
</ul>
<h3 id="6-3-磁盘分区-重点">6.3 磁盘分区[重点]</h3>
<h4 id="6-3-1-电脑启动流程">6.3.1 电脑启动流程</h4>
<p><img src="/img/archlinux_intro/boot_process.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>这一段感觉不知道该怎么讲, 如有讲的不对的地方, 欢迎补充. 我也不知道能否清楚, 我尽力 …</p>
<h4 id="6-3-2-常见术语">6.3.2 常见术语</h4>
<ul>
<li>BIOS</li>
<li>Legacy</li>
<li>Legacy BIOS</li>
<li>UEFI</li>
<li>EFI</li>
<li>ESP</li>
<li>UEFI BIOS</li>
<li>GPT</li>
<li>MBR</li>
<li>BootLoader</li>
<li>Kernel</li>
<li>GRUB(2)</li>
<li>LILO</li>
<li>OC</li>
<li>clover</li>
</ul>
<p><strong>1.BootLoader</strong><br>
&lt;开机管理程序&gt; 或叫做 &lt;启动引导程序&gt;。在加载内核上具有唯一性, 你不能说用 windoes 的 BootLoader 去加载 Linux 的内核, 这是不行的。下边来解释原因, 以Linux下的 GRUB2 为例:</p>
<p>我们上边提到在 BIOS 读完信息后, 接下来就是会到第一个开机设备的 MBR（LBA0）去读取 boot loader 了。这个 boot loader 可以具有:</p>
<ul>
<li>菜单功能、</li>
<li>直接载入核心文件</li>
<li>以及控制权移交的功能等</li>
</ul>
<p>系统必须要有 loader 才有办法载入该操作系统的核心就是了。但是我们都知道,  MBR 是整个硬盘的第一个 sector 内的一个区块, 充其量整个大小也才 446 Bytes 而已。即使是 GPT 也没有很大的扇区来储存 loader 的数据。我们的 loader 功能这么强, 光是程序码与设置数据不可能只占这么一点点的容量吧? 那如何安装?</p>
<p>为了解决这个问题, 所以 Linux 将 boot loader 的程序码执行与设置值载入分成两个阶段来执行:</p>
<ul>
<li>
<p>阶段一: 执行 boot loader 主程序:  第一阶段为执行 boot loader 的主程序, 这个主程序必须要被安装在开机区, 亦即是 MBR 或者是 boot sector 。但如前所述, 因为MBR 实在太小了, 所以, MBR 或 boot sector 通常仅安装 boot loader 的最小主程序,  并没有安装 loader 的相关配置文件；</p>
</li>
<li>
<p>阶段二: 主程序载入配置文件:  第二阶段为通过 boot loader 载入所有配置文件与相关的环境参数文件 （包括<strong>文件系统定义</strong>与主要配置文件 grub.cfg）,  一般来说, 配置文件都在 /boot 下面。</p>
</li>
</ul>
<p><strong>2. BIOS</strong><br>
使用汇编语言写到主板上的一个16位固件（硬件上的软件）—&gt; 计算机执行的第一个程序</p>
<p><strong>3. UEFI</strong><br>
使用C语言写到主板上的一个固件(可以看作一个低级的操作系统), 主要就是想要取代BIOS这个固件接口, 所以又叫做UEFI BIOS</p>
<p><strong>4. EFI（EFI system partition）</strong><br>
GPT格式的硬盘中的系统启动分区, 又叫做ESP分区。 EFI其实就是<strong>系统自动安装</strong>或者是你<strong>手动添加</strong>的一个BootLoader, 通常都是一个**.efi**作为后缀的文件。然后这个BootLoader就会带着主板找到其它操作操作系统的BootLoader, 然后被找到的这个BootLoader就加载这个操作系统的内核内核, 从而启动操作系统。</p>
<p><strong>5. BIOS寻找操作系统的方式</strong><br>
Legacy 和 UEFI → 可以进入BIOS模式后进行设置; 比如在Legacy模式下, 在BIOS中要把第一启动项设为安装由操作系统的那个硬盘。之后BIOS会扫描第一启动硬盘的第一个分区(MBR或这是LBA0),找到boot之类的启动文件,只用利用Loader才能加载系统内核, 从而进入操作系统</p>
<p><strong>6. 磁盘的分区格式</strong><br>
MBR, GPT</p>
<p><strong>7. 加载OS内核</strong><br>
BootLoader的主要工作之一, 常见的BootLoader有GRUB(2), LILO, spfdisk, Boot Manager(windows的boot loader), OC, clover. 好像还有一个叫变色龙是吧?</p>
<blockquote>
<p>黑苹果玩家出来挨打</p>
</blockquote>
<p><strong>8. kernel</strong><br>
就是操作系统的内核, 我们平时说的 <code>Linux</code> 其实应该叫 <code>GNU/Linux</code>; 因为 Linux 是 GNU 组织采用了 Linus 的 Linux 内核产生的</p>
<p><strong>9. (BIOS and UEFI) OR (MBR and GPT)?</strong><br>
下面引用鸟哥书中的一句话:</p>
<blockquote>
<p>如果你的分区表为 GPT 格式的话, 那么 BIOS 也能够从 LBA0 的 MBR相容区块读取第一阶段的启动引导程序代码,  如果你的启动引导程序能够认识 GPT 的话, 那么使用 BIOS 同样可以读取到正确的操作系统核心！换句话说,  如果启动引导程序不懂 GPT , 例如 Windows XP 的环境, 那自然就无法读取核心文件, 开机就失败了</p>
</blockquote>
<p>明确几个点:</p>
<ol>
<li>安装 Windows + Linux 双系统的话, 你应该先安装 windows, 再安装 Linux; windows 的安装会覆盖你的 MBR 和 BootSector, 从而你原本在 MBR 里边的 Linux 的 BootLoader 会被覆盖成 <strong>啥也不能干</strong> 的 windows 的 Boot Manager,然后你就只有使用 Linux 的修复模式来修复 MBR 了</li>
<li>多系统在磁盘上的关系, 如图:GPT也有MBR的兼容区, 所以说只要你在 windows 里边预先分出一块空余的磁盘(不要分区), 之后你在这个分区里边可以使劲造(还是别太使劲了), 你原来的 windows 里边的文件不会受到丝毫的影响（亲身体会）. 但是在安装引导的时候得注意一下:</li>
</ol>
<p><img src="/img/archlinux_intro/system_relation.png" srcset="/img/loading.gif" lazyload alt=""></p>
<ol start="3">
<li>BootLaoder的作用</li>
</ol>
<ul>
<li>提供菜单: 使用者可以选择不同的开机项目, 这也是多重开机的重要功能！</li>
<li>载入核心文件: 直接指向可开机的程序区段来开始操作系统；</li>
<li>转交其他 loader: 将开机管理功能转交给其他 loader 负责。（windows的不行）</li>
</ul>
<p>bootloader的示意图</p>
<p><img src="/img/archlinux_intro/bootloader.png" srcset="/img/loading.gif" lazyload alt=""></p>
<h4 id="6-3-3-引导方案">6.3.3 引导方案</h4>
<p>在本教程中 Linux 的引导不安装在 windows 的 EFI 分区, 转而新建一个 <code>/Boot</code> 分区来存放 Linnux 和 Windows:</p>
<ul>
<li>一部分用户 windows 自带的那个存放 BootLoader 的分区小的可怜(虽然BootLoader也很小)</li>
<li>另一方面是为了防止损坏 windows 原本的引导</li>
</ul>
<h4 id="6-3-4-分区方案">6.3.4 分区方案</h4>
<p>首先在你的 windows 中使用 windows 自带的磁盘管理分出 200G 左右的 free space, 下面是我实体机的分区情况:</p>
<table>
<thead>
<tr>
<th>1G</th>
<th>\boot</th>
<th>fat32</th>
</tr>
</thead>
<tbody>
<tr>
<td>8G</td>
<td>swap</td>
<td>swap</td>
</tr>
<tr>
<td>The rest</td>
<td>\</td>
<td>ext4</td>
</tr>
</tbody>
</table>
<blockquote>
<p>每个人可以按照自己的偏好进行调整, 由于我的实体机已经安装完成, 于是下边在虚拟机中进行演示, 数据按照表格来</p>
</blockquote>
<ol>
<li>
<p>磁盘分区: MBR 格式的硬盘使用fdisk(cfdisk 图形界面),GPT 格式的硬盘使用gdisk(cgdisk 图形界面);<br>
最后一定要写入分区表才有效, 即输入w, 具体的方法我不多讲, 还是简单的;</p>
</li>
<li>
<p>查看分区后磁盘情况, 使用命令:</p>
</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">lsblk                        # 查看分区情况, 如下图<br></code></pre></td></tr></table></figure>
<p><img src="/img/archlinux_intro/disk_partition.png" srcset="/img/loading.gif" lazyload alt=""></p>
<div class="note note-success">
            <p>注: 这个是我已经安装好的虚拟机双系统, 我已经把预留的60G分成了20G windows + 30G Arch; 然后我又把这个 30G 分成: 512M的/boot:/dev/nvme0n1p6 + 4G的swap:/dev/nvme0n1p7 + 30.5GM的/dev/nvme0n1p8</p>
          </div>
<ol start="3">
<li>格式化分区:其实应该叫做格式化文件系统, 常见的文件系统如下:</li>
</ol>
<ul>
<li>windows 下的FAT,  FAT16,  FAT32,  NTFS文件系统</li>
<li>Linux 下的ext2, ext3, ext4, SGI’s XFS, btrfs 文件系统</li>
</ul>
<p>输入以下的命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1. 制作boot分区,  必须为fat格式</span><br>mkfs.fat -F32 /dev/nvme0n1p6<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. 制作swap分区</span><br>mkswap /dev/nvme0n1p7<br>swapon /dev/nvme0n1p7<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">3. 制作主分区的文件系统</span><br>mkfs.ext4 /dev/nvme0n1p8<br><span class="hljs-meta prompt_"># </span><span class="language-bash">或 mkfs -t ext4 /dev/nvme0n1p8</span>                    <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">4. 最好在使用fdisk -l 或者是 lsblk查看各个文件系统的情况</span><br></code></pre></td></tr></table></figure>
<h3 id="6-4-安装基本系统">6.4 安装基本系统</h3>
<h4 id="6-4-1-软件源配置">6.4.1 软件源配置</h4>
<p>因为Arch使用 pacman 作为包管理器, 所以你应该先编辑一下pacman的配置文件, 设置pacman的下载仓库有哪些, 不然仓库没有的话你就会缺少依赖, 然后就会一直改bug. pacman配置文件位于 <code>/etc/pacman.conf</code>, 运行如下的命令进行编辑:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim   /etc/pacman.conf<br></code></pre></td></tr></table></figure>
<p>打开后你会看到Arch自带有三个软件源</p>
<ul>
<li>[core]</li>
<li>[extra]</li>
<li>[community]</li>
</ul>
<p>但是你还应该把另外一个软件源给解封（它默认是被注释了的）—&gt; 给两行解除注释, 就是 <code>[multilib]</code>, 它的作用就是提供 32 位支持库。</p>
<blockquote>
<p>你还可以在添加一个archlinuxcn这个源, 但是它不是官方的源, 是我们中国人自己搞的</p>
</blockquote>
<p>在刚才的那个/etc/pacman.conf文件里边加入下边的内容即可</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell">[archlinuxcn]<br>Server = https://mirrors.ustc.edu.cn/archlinuxcn/$arch                   # 中国科学技术大学开源镜像站<br>Server = https://mirrors.tuna.tsinghua.edu.cn/archlinuxcn/$arch          # 清华大学开源软件镜像站<br>Server = https://mirrors.hit.edu.cn/archlinuxcn/$arch                    # 哈尔滨工业大学开源镜像站<br>Server = https://repo.huaweicloud.com/archlinuxcn/$arch                  # 华为开源镜像站<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">安装这个源你还需要运行下边的命令,安装签名</span><br>sudo pacman -S archlinuxcn-keyring<br><span class="hljs-meta prompt_"># </span><span class="language-bash">最后相比大家安装Arch的一大原因就是看上了它的AUR吧, 据说就没有上边找不到的野包。</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">为此你只需要下载一个yay就行了, yay就可以从AUR中下载软件</span><br>sudo pacman -S yay<br></code></pre></td></tr></table></figure>
<blockquote>
<p>你也可以编辑 pacman 的镜像源, 把中国的镜像源放在最前边, 可能网速会好一点, 和前边的禁用 reflector 一样</p>
</blockquote>
<p>最后就是要更新一下你的系统, 万一不是最新的, 但时候在安装的结束之际给你弹个ERROR出来, 相信我你会裂开的, 怎么更新呢?很简单, 运行下边的命令就可以了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo pacman -Syyu<br></code></pre></td></tr></table></figure>
<h4 id="6-4-2-硬盘安装">6.4.2 硬盘安装</h4>
<p>其实你细心一点就会对发现, 我们的配置都是改的U盘里边的那个系统, 即ISO文件, 根本没有和我们的安装硬盘扯上半点的关系, 毕竟我们是要把Arch安装到电脑的硬盘上, 而不是一个U盘里边。所以要怎么把Arch安装到电脑的硬盘上呢?</p>
<p>这里就涉及到一个Linux下的常用命令: <strong>挂载</strong></p>
<ul>
<li>
<p>什么是挂载? 其实就是把你的储存设备(文件系统, 分区)挂到一个Linux的目录下边, 然后被挂载的目录就叫**挂载点。**你从挂载点进去就是进入了你的那个储存设备</p>
</li>
<li>
<p>什么是目录? 比如 windows下的 <code>C:\users\..\Desktop</code> 就是一个目录, <code>(C:\users\..\)Desktop</code> 就是挂载点.</p>
</li>
</ul>
<p>只不过我们在 Linux 下使用的是 <code>/mnt</code> 这个目录, 作为挂载点; 所以就很简单了, 只需要把电脑的硬盘的分区挂载到 <code>/mnt</code> 目录下, 我们在这个U盘的系统里边, 把东西下载到 <code>/mnt</code> 目录下, 就等于我们把东西下载到电脑的硬盘上了.</p>
<p>回归正题:</p>
<ol>
<li>我们要把 Arch 的系统主要内容安装在主分区, 就是最大的那个 ext4 玩意儿, 也就是 <code>/dev/nvme0n1p6</code></li>
<li>还得把 Arch 的引导安装在 <code>/boot</code> 分区, 也就是 <code>/dev/nvme0n1p8</code></li>
</ol>
<p>挂载操作相关命令如下:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1.挂载主分区</span><br>mount /dev/nvme0n1p8 /mnt<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2.挂载引导分区</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">这也就是他们说的挂载必须从根目录开始的原因, 你不可能直接挂到boot上吧（都没有这个目录呢）</span><br>mkdir /mnt/boot <br><span class="hljs-meta prompt_"># </span><span class="language-bash">此时Arch的pacstrap脚本就会自动把系统的引导安装到这里</span>                                                <br>mount /dev/nvme0n1p6 /mnt/boot                  <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">3.检查挂载情况</span><br>ls /mnt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">如果出现 lost + found 就说明已经挂载上了</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">或是是使用lsblk来查看挂载点</span><br></code></pre></td></tr></table></figure>
<p>接下来就可以开始下载东西来安装了,这么久的前期工作, 终于等来安装了;使用如下的命令即可:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs shell">pacstrap \mnt base linux linux-firmware base-devel vim<br><span class="hljs-meta prompt_"># </span><span class="language-bash">安装过程中一定不能出现报错</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">各个参数的解释:</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">1. pacstrap: <span class="hljs-built_in">arch</span> 自带的一个安装东西的脚本, 可以看作你们平时用的p2p下载, 华军软件源下载, 或者是2345超级下载之类的</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. \mnt: 表示下载的东西放在那里, 因为我们要把Arch安装在主分区是吧, 前边我们也把主分区挂载到了/mnt下,后边的就是要下载的东西。千万别少装, 后边出bug你就知道回来了</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">3. base: 基础软件</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">4. linux: linux的内核,也可以使用其它的内核, 如 linux-lts, linux-zen. 我使用的是 linux-zen</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">5. linux-firmware: 固件</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">6. base-devel:编译的工具, 含有gcc之类的, 提供了make命令等。</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">7. vim: 文本编辑器</span><br></code></pre></td></tr></table></figure>
<blockquote>
<p>有小伙伴可能还会问, 你上边不是说在Linux下, 文件系统是从 <code>/</code> 开始的吗? 而且U盘里变的文件系统是从 <code>/</code> 开始的吗? 怎么又多了一个 <code>/mnt</code> 和 <code>/boot</code> 目录出来呢?</p>
</blockquote>
<p>这个是安装 Arch 过程中的另外一个操作:叫做 <code>arch-chroot</code>; 别着急,后边我们会详细讲解这个命令</p>
<h4 id="6-4-3-fatab文件">6.4.3 fatab文件</h4>
<p>首先恭喜你走到了这一步, 很多人在前边就放弃了, 离胜利不远了; 那么fstab有什么用呢? 还记得我们之前说的吗? 我们是不是手动的把我们的分区挂载到了一些目录下边。但是你的电脑肯定得关机吧, 那么重新开机以后你又得手动去挂载, 麻烦吗? 所以生成 fstab 文件就是在电脑开机后自动读取这个fstab文件, 然后挂载相关的文件系统, 使用如下命令:</p>
<blockquote>
<p>这里的文件系统就是指的分区, 因为一般情况下, 一个分区只能有一个文件系统</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1. 生成 fstab 文件</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">&gt;: 覆盖重写; &gt;&gt;: 表示追加在文件末尾</span><br>genfstab -U /mnt &gt;&gt; /mnt/etc/fstab          <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. 查看fstab文件得信息,检查fstab是否配置成功</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">如果是重新生成可以使用:genfstab -U /mnt &gt; /mnt/etc/fstab</span>            <br>cat /mnt/etc/fstab<br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">cat</span> 是常用得Linux下的查看文件命令</span><br></code></pre></td></tr></table></figure>
<h3 id="6-5-基本环境配置">6.5 基本环境配置</h3>
<p>走完上边的流程, 你得到了一个很简洁的系统, 简洁到代码编辑器,  dhcpcd, 反正要啥没啥。还有就是,现在的系统你肯定很不适应: 语言为英文, 时间也不对 … 但是先别急, 我们还得完成一个操作, 就是前边提到得一个命令 —— <code>arch-chroot</code>. 它有什么用呢? 字面上看就是改变 (change) 根 (root)目录。那么实际意义是什么呢? 对了, 就是这个字面意义</p>
<p>那个改变根目录有什么作用呢?前边我们是不是说过, 在Linux下一切得目录都是从 <code>/</code> 开始的, 也就是说, <code>/</code> 就是最顶层的目录, 你不能够到达比 <code>/</code> 目录更上边的目录了</p>
<blockquote>
<p>这样就可以起到保护你的学习资料, 从而免于被别人偷看</p>
</blockquote>
<p>同时, 它也会改变你的工作目录, 你原来是在 <code>/mnt</code> 下(U盘里), 现在你就在 <code>/</code> 下了(电脑硬盘里,也就是的的新安装的Arch系统里面)这样也就能够解释上边的问题了. 使用如下命令切换根目录:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">arch-chroot /mnt<br><span class="hljs-meta prompt_"># </span><span class="language-bash">此时你的命令提示符会从 root@archiso ~<span class="hljs-comment"># 变为 [root@archiso /]</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">然后就可以执行下边的设置了</span><br></code></pre></td></tr></table></figure>
<div class="note note-success">
            <p>如果你之前在安装时配置了vim, 并且发现在新的系统里边少了一些配置文件, vim使用起来不顺手的话, 你可以退出当前的新系统。你在新系统里边没有你的vim配置文件, 因为你只能使用原来的/mnt下你安装的文件, 而你的vim配置文件在/mnt的上级, 你说, 你怎么使用?此时退出新系统, 进入U盘中的系统重新配置一下, copy过来即可, 使用如下命令退出新系统*</p>
          </div>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">exit<br><span class="hljs-meta prompt_"># </span><span class="language-bash">退出新系统</span><br></code></pre></td></tr></table></figure>
<h4 id="6-5-1-locale-设置">6.5.1 locale 设置</h4>
<p><strong>时区设置</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime<br></code></pre></td></tr></table></figure>
<p><strong>硬件时钟的同步</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">hwclock --systohc<br></code></pre></td></tr></table></figure>
<p><strong>设置locale</strong><br>
什么是locale?实际上就是生活习惯, 根据不同地区人们的不同的生活习惯, 电脑会调整相应的有关东西, 比如语言, 货币, 日期格式等。也就是说让Arch知道我们是中国人, 你的配置得按着我们中国人的习惯来</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs shell">nano /etc/locale.gen<br><span class="hljs-meta prompt_"># </span><span class="language-bash">取消以下两行得注释</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">使用vim的/, 搜索字符串:</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">&quot;#en_US&quot;</span> -&gt; 回车, 找到 <span class="hljs-string">&quot;UTF-8&quot;</span> 那一行 删掉前面的 <span class="hljs-string">&#x27;#&#x27;</span>（取消注释）</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-string">&quot;#zh_CN&quot;</span> -&gt; 回车, 找到 <span class="hljs-string">&quot;UTF-8&quot;</span> 那一行 删掉前面的 <span class="hljs-string">&#x27;#&#x27;</span>（取消注释）</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">% </span><span class="language-bash">生成locale, 因为上边解除注释只是代表我们能用这个locale</span><br>locale-gen<br></code></pre></td></tr></table></figure>
<p><strong>新建 /etc/locale.conf</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/locale.conf <br><span class="hljs-meta prompt_"># </span><span class="language-bash">就是设置你的系统语言了, 添加下边的内容</span><br>LANG=en_US.UTF-8<br><span class="hljs-meta prompt_"># </span><span class="language-bash">不要改成中文的, 不然会造成 <span class="hljs-built_in">tty</span> 乱码</span><br></code></pre></td></tr></table></figure>
<h4 id="6-5-2-设置-host">6.5.2 设置 host</h4>
<ol>
<li>设置 hostname</li>
</ol>
<p>那些改host文件的windows玩家, 这个东西, 你们肯定熟悉吧。你随便设一个英文名就行了, 但是下边配置host的时候名字得一致</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/hostname<br><span class="hljs-meta prompt_"># </span><span class="language-bash">直接填入的hostname即可</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">比如我设置为 Archlinux</span><br></code></pre></td></tr></table></figure>
<ol start="2">
<li>设置 host</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim /etc/hosts<br><span class="hljs-meta prompt_"># </span><span class="language-bash">然后在里边输入如下的内容</span><br>127.0.0.1      localhost<br>::1            localhost<br>127.0.1.1      Archlinux.domain        Archlinux<br><span class="hljs-meta prompt_"># </span><span class="language-bash">提示: 是 tab 键, 不是空格</span><br></code></pre></td></tr></table></figure>
<h4 id="6-5-3-设置-root-密码">6.5.3 设置 root 密码</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">passwd<br><span class="hljs-meta prompt_"># </span><span class="language-bash">然后会叫你输入密码, 不会实时的显示在屏幕上, 但是你的确是输入进去了的</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">最后会叫你确认你的密码, 所以不用担心密码输错</span><br></code></pre></td></tr></table></figure>
<h3 id="6-6-多操作系统引导">6.6 多操作系统引导</h3>
<p>如果你只需要安装单个 Linux 操作系统, 那么这一部分你可以直接跳过; 对于需要安装 Linux+Windows 双系统, 甚至是多个操作系统, 包括 MacOS, 亦或者是多个 Linux 系统的用户来说, 多个操作系统的引导是一个很重要的话题:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">pacman -S grub efibootmgr  intel-ucode os-prober<br><span class="hljs-meta prompt_"># </span><span class="language-bash">1. intel-ucode: 厂家为电脑的cpu更新驱动</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">amd 的 cpu 就安装 amd-ucode</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. grub: 上边说过了, 不多讲</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">3. efibootmgr: efibootmgr 被 grub 脚本用来将启动项写入 NVRAM</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">4. os-prober: 发现 windows 操作系统的引导</span><br></code></pre></td></tr></table></figure>
<h4 id="6-6-1-GRUB基本配置">6.6.1 GRUB基本配置</h4>
<p>具体的详细步骤和参数意义可以参见 Arch 官方维基, 下面以命令</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">fdisk -l<br></code></pre></td></tr></table></figure>
<p>来进行相关信息的查看.可用的参考信息有: 磁盘类型, <code>ESP分区</code> 位置（本例中就是寻找 <code>bootmgfw.efi</code> 所在的分区位置）, 相关命令输出如下:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@Archlinux zpd]# fdisk -l<br>Disk /dev/nvme0n1: 931.51 GiB, 1000204886016 字节, 1953525168 个扇区<br>磁盘型号: WD_BLACK SN770 1TB<br>单元: 扇区 / 1 * 512 = 512 字节<br>扇区大小(逻辑/物理): 512 字节 / 512 字节<br>I/O 大小(最小/最佳): 512 字节 / 512 字节<br>磁盘标签类型: gpt<br>磁盘标识符: 0042EA61-A4D7-452B-9DFA-0AF034C48726<br><br>设备                  起点       末尾       扇区   大小 类型<br>/dev/nvme0n1p1        2048     411647     409600   200M EFI 系统<br>/dev/nvme0n1p2      411648     444415      32768    16M Microsoft 保留<br>/dev/nvme0n1p3      444416 1371561983 1371117568 653.8G Microsoft 基本数据<br>/dev/nvme0n1p4  1925212160 1926260735    1048576   512M Windows 恢复环境<br>/dev/nvme0n1p5  1926260736 1951426559   25165824    12G Windows 恢复环境<br>/dev/nvme0n1p6  1951426560 1953523711    2097152     1G Windows 恢复环境<br>/dev/nvme0n1p7  1505779712 1507876863    2097152     1G Linux 文件系统<br>/dev/nvme0n1p8  1507876864 1524654079   16777216     8G Linux 文件系统<br></code></pre></td></tr></table></figure>
<p>所以我们要寻找的分区就是: <code>/dev/nvme0n1p1</code>, 然后使用如下命令进行挂载操作,挂载点为: <code>/boot</code>.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">mount /dev/nvme0n1p1 /boot<br></code></pre></td></tr></table></figure>
<blockquote>
<p>为了保险起见, 可以查看一下其中是否存在 EFI 文件夹</p>
</blockquote>
<p>然后使用 <code>os-prober</code> 工具查找 <code>bootmgf.efi</code>, 运行如下的命令:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">os-prober<br></code></pre></td></tr></table></figure>
<blockquote>
<p>os-prober 官方认为启动别的操作系统是不安全的, 所以就默认禁用了 os-prober 查找其他操作系统启动文件的功能. 尽管不自动启用, 但你仍然可以修改这一默认行为. 在文件 <code>/etc/default/grub</code> 中增加配置项:<code>GRUB_DISABLE_OS_PROBER=false</code>, 然后再生成我们的 GRUB 配置文件</p>
</blockquote>
<p>如果你可以得到类似如下输出, 就说明 <code>os-prober</code> 找到了 windows 的启动引导项了:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@Archlinux zpd]# os-prober<br>/dev/nvme0n1p1@/EFI/Microsoft/Boot/bootmgfw.efi:Windows Boot Manager:Windows:efi<br></code></pre></td></tr></table></figure>
<p>之后就是如下的常规操作:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1. 创建一个文件夹</span><br>mkdir /boot/grub<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. 生成配置文件</span><br>grub-mkconfig &gt; /boot/grub/grub.cfg         <br><span class="hljs-meta prompt_"># </span><span class="language-bash">也可以用: grub-mkconfig -o /boot/grub/grub.cfg</span><br></code></pre></td></tr></table></figure>
<h4 id="6-6-2-GRUB-主题">6.6.2 GRUB 主题</h4>
<p>GRUB 默认的主题是纯黑白的, 大概就像下面这样(示例图片选自:<a target="_blank" rel="noopener" href="https://www.techmesto.com/set-windows-as-default-in-linux-dual-boot/">linux-grub-windows-dual-boot</a>):</p>
<p><img src="/img/archlinux_intro/linux-grub-windows-dual-boot.png" srcset="/img/loading.gif" lazyload alt="linux-grub-windows-dual-boot"></p>
<p>可能部分的用户并不喜欢, 所以我们可以自定义这个 grub 菜单界面的主题。这里采用的工具是: <a target="_blank" rel="noopener" href="https://github.com/vinceliuice/grub2-themes">grub2-themes</a>, 它提供的主题样式如下:</p>
<p><img src="/img/archlinux_intro/grub-theme-preview.png" srcset="/img/loading.gif" lazyload alt=""></p>
<p>这个工具的使用十分的简单, 只需参考仓库对应的README即可, 但是我还是在这里补充一些易错点.其实主要的问题就出现在 os-prober 寻找 windows 的 <code>.efi</code> 上, 下面是我在默认的 windows 和 Linux 的引导都正常下的配置<br>
方法:</p>
<ol>
<li>首先把 Windows 的 <code>.efi</code> 文件对应的分区挂载到 Linux 的 <code>/boot/EFI</code> 文件夹下, windows 的 <code>.efi</code> 文件在我这里位于 <code>/dev/nvme0n1p1</code> 分区. 所以使用命令: <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo mount /dev/nvme0n1p1 /boot/EFI<br></code></pre></td></tr></table></figure>
</li>
<li>然后运行命令: <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo os-prober<br></code></pre></td></tr></table></figure>
看一看是否能检测到 Linux 和 Windows 两个系统的启动文件, 如果正常的话, 应该会有类似如下的输出: <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">$ </span><span class="language-bash">sudo grub-mkcontig temp.cfg</span><br>Generating grub configuration file ...<br>Found theme:/usr/share/grub/themes/vimix/theme.txt<br>Found linux image:/boot/vmlinuz-linux-zen<br>Found initrd image:/boot/intel-ucode.img /boot/initramfs-linux-zen.img<br>Found fallback initrd image(s)in /boot:intel-ucode.img initramfs-linux-zen-fallback.img<br>Warning:os-prober will be executed to detect other bootable partitions<br>Its output will be used to detect bootable binaries on them and create new boot entries.<br>Found Windows Boot Manager on /dev/nvmeon1p1@/EFI/Microsoft/Boot/bootmgfw.efi<br>Adding boot menu entry for UEFI Firmware Settings ..<br>done<br></code></pre></td></tr></table></figure>
尤其得关注那个 <code>Windows Boot Manager</code> 项.</li>
<li>如果以上两步均正常, 那么最后可以使用 grub2-themes 提供的脚本命令生成对应的 grub 配置 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo ./install.sh -t vimix -s 1080p<br></code></pre></td></tr></table></figure>
最后再检查一下对应的 grub 配置文件: <code>/boot/grub/grub.cfg</code> 是否正常, 我最后的文件长这样(不要抄袭, 每个人的情况是不同的): <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-comment"># DO NOT EDIT THIS FILE</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-comment"># It is automatically generated by grub-mkconfig using templates</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">from /etc/grub.d and settings from /etc/default/grub</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"></span><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/00_header ###</span></span><br>insmod part_gpt<br>insmod part_msdos<br>if [ -s $prefix/grubenv ]; then<br>load_env<br>fi<br>if [ &quot;$&#123;next_entry&#125;&quot; ] ; then<br>set default=&quot;$&#123;next_entry&#125;&quot;<br>set next_entry=<br>save_env next_entry<br>set boot_once=true<br>else<br>set default=&quot;0&quot;<br>fi<br><br>if [ x&quot;$&#123;feature_menuentry_id&#125;&quot; = xy ]; then<br>menuentry_id_option=&quot;--id&quot;<br>else<br>menuentry_id_option=&quot;&quot;<br>fi<br><br>export menuentry_id_option<br><br>if [ &quot;$&#123;prev_saved_entry&#125;&quot; ]; then<br>set saved_entry=&quot;$&#123;prev_saved_entry&#125;&quot;<br>save_env saved_entry<br>set prev_saved_entry=<br>save_env prev_saved_entry<br>set boot_once=true<br>fi<br><br>function savedefault &#123;<br>if [ -z &quot;$&#123;boot_once&#125;&quot; ]; then<br>    saved_entry=&quot;$&#123;chosen&#125;&quot;<br>    save_env saved_entry<br>fi<br>&#125;<br><br>function load_video &#123;<br>if [ x$feature_all_video_module = xy ]; then<br>    insmod all_video<br>else<br>    insmod efi_gop<br>    insmod efi_uga<br>    insmod ieee1275_fb<br>    insmod vbe<br>    insmod vga<br>    insmod video_bochs<br>    insmod video_cirrus<br>fi<br>&#125;<br><br>if [ x$feature_default_font_path = xy ] ; then<br>font=unicode<br>else<br>insmod part_gpt<br>insmod ext2<br>search --no-floppy --fs-uuid --set=root 95e4daca-8211-4bb5-8407-1bfd1123e560<br>    font=&quot;/usr/share/grub/unicode.pf2&quot;<br>fi<br><br>if loadfont $font ; then<br>set gfxmode=1920x1080,auto<br>load_video<br>insmod gfxterm<br>set locale_dir=$prefix/locale<br>set lang=en_US<br>insmod gettext<br>fi<br>terminal_input console<br>terminal_output gfxterm<br>insmod part_gpt<br>insmod ext2<br>search --no-floppy --fs-uuid --set=root 95e4daca-8211-4bb5-8407-1bfd1123e560<br>insmod gfxmenu<br>loadfont ($root)/usr/share/grub/themes/vimix/dejavu_sans_12.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/dejavu_sans_14.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/dejavu_sans_16.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/dejavu_sans_24.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/dejavu_sans_32.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/dejavu_sans_48.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/terminus-12.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/terminus-14.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/terminus-16.pf2<br>loadfont ($root)/usr/share/grub/themes/vimix/terminus-18.pf2<br>insmod jpeg<br>insmod png<br>set theme=($root)/usr/share/grub/themes/vimix/theme.txt<br>export theme<br>if [ x$feature_timeout_style = xy ] ; then<br>set timeout_style=menu<br>set timeout=-1<br><span class="hljs-meta prompt_"># </span><span class="language-bash">Fallback normal <span class="hljs-built_in">timeout</span> code <span class="hljs-keyword">in</span> <span class="hljs-keyword">case</span> the timeout_style feature is</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">unavailable.</span><br>else<br>set timeout=-1<br>fi<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/00_header ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/10_linux ###</span></span><br>menuentry &#x27;Arch Linux, with Linux linux-zen&#x27; --class arch --class gnu-linux --class gnu --class os $menuentry_id_option &#x27;gnulinux-linux-zen-advanced-95e4daca-8211-4bb5-8407-1bfd1123e560&#x27; &#123;<br>    savedefault<br>    load_video<br>    set gfxpayload=keep<br>    insmod gzio<br>    insmod part_gpt<br>    insmod fat<br>    search --no-floppy --fs-uuid --set=root F8A7-B7F8<br>    echo	&#x27;Loading Linux linux-zen ...&#x27;<br>    linux	/vmlinuz-linux-zen root=UUID=95e4daca-8211-4bb5-8407-1bfd1123e560 rw  loglevel=5 quiet nowatchdog<br>    echo	&#x27;Loading initial ramdisk ...&#x27;<br>    initrd	/intel-ucode.img /initramfs-linux-zen.img<br>&#125;<br>menuentry &#x27;Arch Linux, with Linux linux-zen (fallback initramfs)&#x27; --class arch --class gnu-linux --class gnu --class os $menuentry_id_option &#x27;gnulinux-linux-zen-fallback-95e4daca-8211-4bb5-8407-1bfd1123e560&#x27; &#123;<br>    savedefault<br>    load_video<br>    set gfxpayload=keep<br>    insmod gzio<br>    insmod part_gpt<br>    insmod fat<br>    search --no-floppy --fs-uuid --set=root F8A7-B7F8<br>    echo	&#x27;Loading Linux linux-zen ...&#x27;<br>    linux	/vmlinuz-linux-zen root=UUID=95e4daca-8211-4bb5-8407-1bfd1123e560 rw  loglevel=5 quiet nowatchdog<br>    echo	&#x27;Loading initial ramdisk ...&#x27;<br>    initrd	/intel-ucode.img /initramfs-linux-zen-fallback.img<br>&#125;<br>menuentry &#x27;Arch Linux, with Linux linux-zen (recovery mode)&#x27; --class arch --class gnu-linux --class gnu --class os $menuentry_id_option &#x27;gnulinux-linux-zen-recovery-95e4daca-8211-4bb5-8407-1bfd1123e560&#x27; &#123;<br>    load_video<br>    set gfxpayload=keep<br>    insmod gzio<br>    insmod part_gpt<br>    insmod fat<br>    search --no-floppy --fs-uuid --set=root F8A7-B7F8<br>    echo	&#x27;Loading Linux linux-zen ...&#x27;<br>    linux	/vmlinuz-linux-zen root=UUID=95e4daca-8211-4bb5-8407-1bfd1123e560 rw single <br>    echo	&#x27;Loading initial ramdisk ...&#x27;<br>    initrd	/intel-ucode.img /initramfs-linux-zen-fallback.img<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/10_linux ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/20_linux_xen ###</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/20_linux_xen ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/25_bli ###</span></span><br>if [ &quot;$grub_platform&quot; = &quot;efi&quot; ]; then<br>insmod bli<br>fi<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/25_bli ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/30_os-prober ###</span></span><br>menuentry &#x27;Windows Boot Manager (on /dev/nvme0n1p1)&#x27; --class windows --class os $menuentry_id_option &#x27;osprober-efi-94D9-50AD&#x27; &#123;<br>    savedefault<br>    insmod part_gpt<br>    insmod fat<br>    search --no-floppy --fs-uuid --set=root 94D9-50AD<br>    chainloader /EFI/Microsoft/Boot/bootmgfw.efi<br>&#125;<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/30_os-prober ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/30_uefi-firmware ###</span></span><br>if [ &quot;$grub_platform&quot; = &quot;efi&quot; ]; then<br>    fwsetup --is-supported<br>    if [ &quot;$?&quot; = 0 ]; then<br>        menuentry &#x27;UEFI Firmware Settings&#x27; $menuentry_id_option &#x27;uefi-firmware&#x27; &#123;<br>            fwsetup<br>        &#125;<br>    fi<br>fi<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/30_uefi-firmware ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/40_custom ###</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">This file provides an easy way to add custom menu entries.  Simply <span class="hljs-built_in">type</span> the</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">menu entries you want to add after this comment.  Be careful not to change</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">the <span class="hljs-string">&#x27;exec tail&#x27;</span> line above.</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/40_custom ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/41_custom ###</span></span><br>if [ -f  $&#123;config_directory&#125;/custom.cfg ]; then<br>source $&#123;config_directory&#125;/custom.cfg<br>elif [ -z &quot;$&#123;config_directory&#125;&quot; -a -f  $prefix/custom.cfg ]; then<br>source $prefix/custom.cfg<br>fi<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/41_custom ###</span></span><br></code></pre></td></tr></table></figure>
然后取消挂载, 重启, 即可看到效果</li>
</ol>
<p>再说一说我在这个过程中遇到的另一个坑吧. 我当时把 <code>/dev/nvme0n1p1</code> 分区挂载到了 <code>/boot</code> 目录下, 然后再运行 os-prober 命令就只能找到 Windows 的启动文件, 但是就找不到 Linux 的启动文件了, 这种情况下输出的 <code>grub.cfg</code> 文件大概长这样:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-comment"># DO NOT EDIT THIS FILE</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"><span class="hljs-comment"># It is automatically generated by grub-mkconfig using templates</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">from /etc/grub.d and settings from /etc/default/grub</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"></span><br><span class="language-bash"></span><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/00_header ###</span></span><br>insmod part_gpt<br>insmod part_msdos<br>if [ -s $prefix/grubenv ]; then<br>  load_env<br>fi<br>if [ &quot;$&#123;next_entry&#125;&quot; ] ; then<br>   set default=&quot;$&#123;next_entry&#125;&quot;<br>   set next_entry=<br>   save_env next_entry<br>   set boot_once=true<br>else<br>   set default=&quot;0&quot;<br>fi<br><br>if [ x&quot;$&#123;feature_menuentry_id&#125;&quot; = xy ]; then<br>  menuentry_id_option=&quot;--id&quot;<br>else<br>  menuentry_id_option=&quot;&quot;<br>fi<br><br>export menuentry_id_option<br><br>if [ &quot;$&#123;prev_saved_entry&#125;&quot; ]; then<br>  set saved_entry=&quot;$&#123;prev_saved_entry&#125;&quot;<br>  save_env saved_entry<br>  set prev_saved_entry=<br>  save_env prev_saved_entry<br>  set boot_once=true<br>fi<br><br>function savedefault &#123;<br>  if [ -z &quot;$&#123;boot_once&#125;&quot; ]; then<br>    saved_entry=&quot;$&#123;chosen&#125;&quot;<br>    save_env saved_entry<br>  fi<br>&#125;<br><br>function load_video &#123;<br>  if [ x$feature_all_video_module = xy ]; then<br>    insmod all_video<br>  else<br>    insmod efi_gop<br>    insmod efi_uga<br>    insmod ieee1275_fb<br>    insmod vbe<br>    insmod vga<br>    insmod video_bochs<br>    insmod video_cirrus<br>  fi<br>&#125;<br><br>if [ x$feature_default_font_path = xy ] ; then<br>   font=unicode<br>else<br>insmod part_gpt<br>insmod ext2<br>search --no-floppy --fs-uuid --set=root 95e4daca-8211-4bb5-8407-1bfd1123e560<br>    font=&quot;/usr/share/grub/unicode.pf2&quot;<br>fi<br><br>if loadfont $font ; then<br>  set gfxmode=1920x1080,auto<br>  load_video<br>  insmod gfxterm<br>  set locale_dir=$prefix/locale<br>  set lang=en_US<br>  insmod gettext<br>fi<br>terminal_input console<br>terminal_output gfxterm<br>if [ x$feature_timeout_style = xy ] ; then<br>  set timeout_style=menu<br>  set timeout=-1<br><span class="hljs-meta prompt_"># </span><span class="language-bash">Fallback normal <span class="hljs-built_in">timeout</span> code <span class="hljs-keyword">in</span> <span class="hljs-keyword">case</span> the timeout_style feature is</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">unavailable.</span><br>else<br>  set timeout=-1<br>fi<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/00_header ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/10_linux ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/10_linux ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/20_linux_xen ###</span></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/20_linux_xen ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/25_bli ###</span></span><br>if [ &quot;$grub_platform&quot; = &quot;efi&quot; ]; then<br>  insmod bli<br>fi<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/25_bli ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/30_os-prober ###</span></span><br>menuentry &#x27;Windows Boot Manager (on /dev/nvme0n1p1)&#x27; --class windows --class os $menuentry_id_option &#x27;osprober-efi-94D9-50AD&#x27; &#123;<br>	savedefault<br>	insmod part_gpt<br>	insmod fat<br>	search --no-floppy --fs-uuid --set=root 94D9-50AD<br>	chainloader /EFI/Microsoft/Boot/bootmgfw.efi<br>&#125;<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/30_os-prober ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/30_uefi-firmware ###</span></span><br>if [ &quot;$grub_platform&quot; = &quot;efi&quot; ]; then<br>	fwsetup --is-supported<br>	if [ &quot;$?&quot; = 0 ]; then<br>		menuentry &#x27;UEFI Firmware Settings&#x27; $menuentry_id_option &#x27;uefi-firmware&#x27; &#123;<br>			fwsetup<br>		&#125;<br>	fi<br>fi<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/30_uefi-firmware ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/40_custom ###</span></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">This file provides an easy way to add custom menu entries.  Simply <span class="hljs-built_in">type</span> the</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">menu entries you want to add after this comment.  Be careful not to change</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">the <span class="hljs-string">&#x27;exec tail&#x27;</span> line above.</span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/40_custom ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/41_custom ###</span></span><br>if [ -f  $&#123;config_directory&#125;/custom.cfg ]; then<br>  source $&#123;config_directory&#125;/custom.cfg<br>elif [ -z &quot;$&#123;config_directory&#125;&quot; -a -f  $prefix/custom.cfg ]; then<br>  source $prefix/custom.cfg<br>fi<br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/41_custom ###</span></span><br></code></pre></td></tr></table></figure>
<p>可以看到:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## BEGIN /etc/grub.d/10_linux ###</span></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_">#</span><span class="language-bash"><span class="hljs-comment">## END /etc/grub.d/10_linux ###</span></span><br></code></pre></td></tr></table></figure>
<p>之间根本就没有任何的 Linux 启动选项, 所以导致我的 GRUB 菜单中只有一个 windows 启动项. 但是我这次并没有通过 LiveCD 进行对应的 <code>grub.cfg</code> 文件的更改, 我直接在 Windows 下使用 <code>Disk Genius</code> 修改的. 操作示意图如下:</p>
<p><img src="/img/archlinux_intro/disk_genius_grub.png" srcset="/img/loading.gif" lazyload alt="disk genius -- grub.cfg"></p>
<p>上图中的那个 <code>分区(4)</code> 其实就是我那个 Linux 文件系统下的 <code>/boot</code> 文件夹, 所以我们要修改的文件就是那个: <code>grub.cfg</code>, 修改好之后, 再替换原始的文件.重启系统, 马上恢复正常引导.</p>
<blockquote>
<p>不建议新手像我这样手动修改 <code>grub.cfg</code> 文件, 但是如果你熟悉这个文件的结构和语法, 那我反而更推崇手写这个文件, archlinux 的官方文档中也有对应的 grub 启动菜单配置教程: <a target="_blank" rel="noopener" href="https://wiki.archlinux.org/title/GRUB#Boot_menu_entry_examples">grub menu</a></p>
</blockquote>
<p>最后的效果如下:</p>
<p><img src="/img/archlinux_intro/grub_menu.jpg" srcset="/img/loading.gif" lazyload alt="grub menu"></p>
<blockquote>
<p>实体机的 GRUB menu 界面不好截图，手机像素有点差，将就看吧</p>
</blockquote>
<h4 id="6-6-3-救赎-–-引导丢失">6.6.3 救赎 – 引导丢失</h4>
<p>下面就说一个我亲身体验的:系统引导丢失, 无法进入系统的案件</p>
<blockquote>
<p>某次我使用 timeshift 恢复系统时, 它问我要不要恢复 grub 引导, 然后我选择了同意。自然而然的, 重启后无法进入系统了（Arch 和 windows）。就连启动 windows 都只能够进入 BIOS 进行选择启动项了, 也就是说我的GRUB崩了。</p>
</blockquote>
<p>然后我就重新制作了一个启动盘, 进入 LiveCD 模式, 也就是 Arch 的安装时的模式。重新把 Arch 的主分区和 boot 分区分别挂载在了<code>/mnt</code> 和 <code>/mnt/boot</code> 目录.</p>
<blockquote>
<p>尽量不要颠倒下面命令的执行顺序</p>
</blockquote>
<ol>
<li>重新生成了 fstab 文件</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">genfstab -U /mnt &gt;&gt; /mnt/etc/fstab<br></code></pre></td></tr></table></figure>
<ol start="2">
<li>重新安装了 Arch 的内核, 也就是如下的命令:</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">pacstrap \mnt  linux<br></code></pre></td></tr></table></figure>
<ol start="3">
<li>重新挂载 windows 的 ESP 分区到 <code>/mnt/boot</code> 目录. 使用命令</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">os-prober<br></code></pre></td></tr></table></figure>
<p>找到 Linux 和 Windows 的引导文件</p>
<ol start="4">
<li>重新生成 GRUB 的启动引导项</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">grub-mkconfig &gt; /boot/grub/grub.cfg         <br><span class="hljs-meta prompt_"># </span><span class="language-bash">也可以用:  grub-mkconfig -o /boot/grub/grub.cfg</span><br></code></pre></td></tr></table></figure>
<ol start="5">
<li>最后</li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">exit<br></code></pre></td></tr></table></figure>
<p>重启, GRUB 成功引导 arch 和 Windows 两个系统</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs shell">[root@Archlinux zpd]# grub-mkconfig &gt; /boot/grub/grub.cfg<br>正在生成 grub 配置文件 ...<br>警告:  os-prober 将运行以检测其它可引导分区。<br>将使用 os-prober 的输出, 以检测分区中可引导的二进制文件, 并为其创建新的启动项。<br>发现了 Windows Boot Manager, 位于 /dev/nvme0n1p1@/EFI/Microsoft/Boot/bootmgfw.efi<br>正在添加 UEFI 固件设置的引导菜单项……<br>完成<br></code></pre></td></tr></table></figure>
<h3 id="6-7-基本软件">6.7 基本软件</h3>
<h4 id="6-7-1-计算机联网">6.7.1 计算机联网</h4>
<p>为了方便之后的网络连接以及管理, 我个人安装了如下软件:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo pacman -S networkmanager network-manager-applet  wpa_supplicant<br></code></pre></td></tr></table></figure>
<h4 id="6-7-2-其余软件">6.7.2 其余软件</h4>
<p>还有一部分额外的软件, 可以根据个人喜好进行安装:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs shell">sudo pacman -S mtools git dosfstools ntfs-3g sudo linux-headers<br><span class="hljs-meta prompt_"># </span><span class="language-bash">1. mtools, dosfstools: Linux下的工具程序</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. git: 分布式版本管理工具</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">3. ntfs-3g: 兼容ntfs文件系统</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">4. sudo: 不多讲了</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">5. linux-headers: 就是格式规范的、可以被编译器识别的软件接口规格书</span><br></code></pre></td></tr></table></figure>
<h4 id="6-7-3-完成安装">6.7.3 完成安装</h4>
<p>完成以上的所有任务后, 恭喜你, 你得到了一个 Archlinux 系统, 蓝色双面鹰永在. 退出安装, 准备进行系统:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">exit          # 退出安装环境<br>umountmnt     # 取消文件系统的挂载<br>reboot        # 重启<br></code></pre></td></tr></table></figure>
<h3 id="6-8-进入系统">6.8 进入系统</h3>
<h4 id="6-8-1-连接网络">6.8.1 连接网络</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">设置开机自启并且现在就启动</span><br>systemctl enable --now NetworkManager<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">进入图形化的wifi连接界面</span><br>nmtui<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">每天一边遍,防止滚挂</span><br>sudo pacman -Syyu<br></code></pre></td></tr></table></figure>
<h4 id="6-8-2-root-默认编辑器">6.8.2 root 默认编辑器</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs shell">vim  ~/.bash.profile<br><span class="hljs-meta prompt_"># </span><span class="language-bash">添加如下的内容</span><br>export EDITOR=&#x27;vim&#x27;<br></code></pre></td></tr></table></figure>
<h4 id="6-8-3-准备非-root-用户">6.8.3 准备非 root 用户</h4>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1. 添加用户</span><br>useradd -m -G wheel  &lt;your name&gt;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. 创建密码, 注意别去改root</span><br>passwd &lt;your name&gt;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">3. 取消wheel用户组的注释</span><br>EDITOR=vim visudo                                    <br><span class="hljs-meta prompt_"># </span><span class="language-bash">也就是去掉 <span class="hljs-comment">#%wheel ALL=(ALL) AL前边的注释</span></span><br></code></pre></td></tr></table></figure>
<h4 id="6-8-4-DE-环境安装">6.8.4 DE 环境安装</h4>
<p>我这里的教程只保证你们安装好基本的 Display server, 至于你们喜欢什么桌面环境, 这个也许需要你自己去选择.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">1. 安装显示服务</span><br>sudo pacman -S xorg                <br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2. 安装显卡驱动</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2.1 核显:Intel</span><br>sudo pacman -S mesa lib32-mesa vulkan-intel lib32-vulkan-intel    <br><span class="hljs-meta prompt_"># </span><span class="language-bash">amd请参见:archwiki</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">2.2 独立显卡</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">A 卡</span><br>pacman -S xf86-video-amdgpu        <br><span class="hljs-meta prompt_"># </span><span class="language-bash">N 卡</span><br>pacman -S nvidia nvidia-utils      <br></code></pre></td></tr></table></figure>
<h4 id="6-8-5-平铺桌面">6.8.5 平铺桌面</h4>
<p>如果用户喜欢轻量化的平铺桌面管理器, 我这里倒是有一个推荐的配置: <a target="_blank" rel="noopener" href="https://github.com/yaocccc/dwm">yaocccc-dwm</a>. 配置好的效果大概是这样: <a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1Ef4y1Z7kA/?share_source=copy_web&amp;vd_source=a9d745bfbf443d7fec13113cdd89ee46">yaocccc-dwm-showoff</a>. 我目前的桌面大概长这样:</p>
<p><img src="/img/archlinux_intro/dwm-example.png" srcset="/img/loading.gif" lazyload alt="dwm-example"></p>
<h2 id="7-日前现状">7 日前现状</h2>
<h3 id="7-1-痛点">7.1 痛点</h3>
<p>Windows 上的那些软件自然不能迁移到 Linux 下, 如:</p>
<ul>
<li>大型工业软件如 SolidWorks, AutoCAD, Matlab.</li>
<li>还有数学软件 Mathematica, Maple.</li>
<li>最后就是 Adobe 系列</li>
</ul>
<p>这些东西都没有办法迁移(大部分的用户应该都用不起正版 + 找不到linux的&quot;科技&quot;版). 可是既然你已经开始使用 Linux 了, 就说明你应该接纳 Linux, 上边的要求(要求 Linux 有 Windows 上的软件),也许有些过于的苛刻了. Linux 完全可以反问一句:我为什么要有这些软件呢? 的确也是这个道理。其实如果仅仅只是想要体验一下, 装个虚拟机, 尽管性能比较差, 但是也够了.</p>
<h3 id="7-2-软件推荐">7.2 软件推荐</h3>
<div class="note note-danger">
            <p>我现在又用回 Windows 了, weztrem 这个终端模拟器 + WSL2 还是很能打的.</p>
          </div>
<p>但是在Linux下我的日常生活所需基本都能够满足, 主要是依靠如下的软件:</p>
<ol>
<li>写作: LaTeX, WPS; 目前我使用 LaTeX 写论文, 制作演示文稿, 对应的表格需求很少</li>
<li>音乐: spotify, 网易云(而且有人基于网页端封装了一个), qqMusic 还不错</li>
<li>代码: Jetbrain 全家桶 + (n)vim, code-oss(VScode 的开源版本)</li>
<li>文档查看器: okular, zathura</li>
<li>交友通讯: linuxqq, 微信暂时无解, Telegram</li>
<li>科学上网: V2aray, clash-for-windows, 现在那个 <code>dae</code> 似乎比较的火.</li>
<li>终端: simple-terminal(suckless), wezterm(目前在 Windows 上用着很舒服，打算迁移到 Linux 上), konsole 还不错</li>
<li>终端小工具: ranger, yazi, autojump,</li>
</ol>
<blockquote>
<p>这两个东西是类似于端口代理的, 不是其他的VPN软件那样全局的代理, 附注一张图,懂得自然懂:</p>
</blockquote>
<p><img src="/img/archlinux_intro/proxy.png" srcset="/img/loading.gif" lazyload alt="取自知乎"></p>
<ol start="7">
<li>
<p>浏览器: Vivalda, Chrome</p>
</li>
<li>
<p>剪辑绘图: kdenlive, Gimp, krita, inkscape</p>
</li>
<li>
<p>输入法: fcxit5+rime, 好像还有一个 <code>oh-my-rime</code> 感兴趣的可以看看.</p>
<blockquote>
<p>输入法的坑:  在某些应用中无法切换中文输入, 比如 dolphin, gedit, telegram …</p>
</blockquote>
<p>解决方法也是比较简单的，首先运行命令进行输入法的配置检查:</p>
 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">fcitx-diagnose                        <br><span class="hljs-meta prompt_"># </span><span class="language-bash">或者是 fcitx-diagnose 来查看潜在问题（你按照它的提示基本都可以 解决bug）</span><br></code></pre></td></tr></table></figure>
<p>基本都是更改以下的几个配置文件:</p>
<ul>
<li><code>/etc/profile</code></li>
<li><code>～/.xprofile</code></li>
<li><code>/etc/environment</code></li>
</ul>
</li>
<li>
<p>专业软件: Matlab ☞ Octave, Mathematica</p>
</li>
</ol>
<h3 id="7-3-DE-相关">7.3 DE 相关</h3>
<p>目前我的桌面环境是: 我没有桌面环境(DE), 我用的就是简单的 <code>xorg</code> + <code>picom</code> + <code>dwm</code>.个人感觉其他的 GUI 太重了, 不喜欢. 至于游戏, 我不打游戏的, 据说 Linux 的游戏体验不咋的.</p>
<h2 id="8-Linux-基础知识-技巧">8. Linux 基础知识/技巧</h2>
<p>新手刚接触 Linux 难免会有些摸不着头脑，我自己平时也总结了一些常用技巧，就列在这里，希望能帮助到大家.</p>
<blockquote>
<p>下面的部分技巧可能并不是通用的，请注意</p>
</blockquote>
<h3 id="8-1-zsh-终端小技巧">8.1 zsh 终端小技巧</h3>
<ul>
<li><code>&amp;</code>	      : 在一个命令后面添加&amp;可以把命令放到后台执行</li>
<li><code>ctrl + z</code>  : 把正在前台执行的命令放到后台并“暂停”（在命令行窗口输出）</li>
<li><code>jobs</code>      : 查看当前在后台执行的命令</li>
<li><code>fg %[num]</code> : 将后台命令调到前台(这里的num不是pid,是jobs命令返回的进程编号)，对应的命令bg</li>
<li><code>ps</code>        : 列出系统中正在运行的进程（很少，很实用）</li>
<li><code>htop</code>      : 列出系统进程（更加的详细的系统进程信息，比较多）</li>
<li><code>Ctrl + r</code>  : 搜索历史命令</li>
</ul>
<h3 id="8-2-系统管理员知识">8.2 系统管理员知识</h3>
<ul>
<li><code>sudo pacman -S package_name</code> # 安装软件包</li>
<li><code>pacman -Ss</code> # 在同步数据库中搜索包，包括包的名称和描述</li>
<li><code>sudo pacman -Syyu</code> # 升级系统。-yy：标记强制刷新、-u：标记升级动作</li>
<li><code>sudo pacman -Rns package_name</code> # 删除软件包，及其所有没有被其他已安装软件包使用的依赖包</li>
<li><code>sudo pacman -R package_name</code> # 删除软件包，保留其全部已经安装的依赖关系</li>
<li><code>pacman -Qi package_name</code> # 检查已安装包的相关信息。-Q：查询本地软件包数据库</li>
<li><code>pacman -Qdt</code> # 找出孤立包。-d：标记依赖包、-t：标记不需要的包、-dt：合并标记孤立包</li>
<li><code>sudo pacman -Fy</code> # 更新命令查询文件列表数据库</li>
<li><code>pacman -F some_command</code> # 当不知道某个命令属于哪个包时，用来在远程软件包中查询某个命令属于哪个包（即使没有安装）</li>
<li><code>pactree package_name</code> # 查看一个包的依赖树)</li>
<li><code>sudo pacman -Rns $(pacman -Qtdq)   </code> # 删除孤立软件包（常用）</li>
<li><code>sudo pacman -Sc</code> # 删除当前未安装的所有缓存包和未使用的同步数据库（可选）</li>
<li><code>sudo pacman -Scc</code> # 从缓存中删除所有文件，这是最激进的方法，不会在缓存文件夹中留下任何内容（一般不使用）</li>
<li><code>paccache -r</code> # 删除已安装和未安装包的所有缓存版本，但最近 3 个版本除外)</li>
</ul>
<h3 id="8-3-系统服务的管理">8.3 系统服务的管理</h3>
<ul>
<li><code>systemctl start dhcpcd</code> # 启动服务</li>
<li><code>systemctl stop dhcpcd</code> # 停止服务</li>
<li><code>systemctl restart dhcpcd</code> # 重启服务</li>
<li><code>systemctl reload dhcpcd</code> # 重新加载服务以及它的配置文件</li>
<li><code>systemctl status dhcpcd</code> # 查看服务状态</li>
<li><code>systemctl enable dhcpcd</code> # 设置开机启动服务</li>
<li><code>systemctl enable --now dhcpcd</code> # 设置服务为开机启动并立即启动这个单元</li>
<li><code>systemctl disable dhcpcd</code> # 取消开机自动启动</li>
<li><code>systemctl daemon-reload dhcpcd</code> # 重新载入 systemd 配置。扫描新增或变更的服务单元、不会重新加载变更的配置</li>
</ul>
<h3 id="8-4-top-命令">8.4 top 命令</h3>
<ul>
<li><code>z</code>: 开启高亮</li>
<li><code>x</code>: 高亮一列</li>
<li><code>b</code>: 高亮一行</li>
<li><code>&gt;/&lt;</code>: 进行左右移动</li>
</ul>
<h3 id="8-5-其余技巧">8.5 其余技巧</h3>
<ul>
<li><code>nohup &lt;cmd&gt; &amp;</code>: 让命令在后台运行,不输出运行日志</li>
<li><code>pkill</code>: 可以杀死一个进程的父进程和子进程</li>
<li><code>pstree</code>: 显示进程树</li>
<li><code>htop</code>: 显示进程信息，支持鼠标操作/排序</li>
</ul>
<h2 id="9-配置文件">9 配置文件</h2>
<h3 id="9-1-zshrc">9.1 zshrc</h3>
<p>这里给一部分我的 zsh 终端的配置文件吧，个人感觉对于新手有一定的帮助.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><code class="hljs shell"><span class="hljs-meta prompt_"># </span><span class="language-bash">Zsh的语言高亮和建议</span><br>source /usr/share/zsh/plugins/zsh-autosuggestions/zsh-autosuggestions.zsh<br>source /usr/share/zsh/plugins/zsh-syntax-highlighting/zsh-syntax-highlighting.zsh<br>[[ -s /etc/profile.d/autojump.sh ]] &amp;&amp; source /etc/profile.d/autojump.sh<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">use comand <span class="hljs-string">&quot;env&quot;</span> to find out</span> <br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">export</span> PS1=<span class="hljs-string">&quot;%n@%c &gt;&gt; &quot;</span></span><br>if [[ $(tty) == &quot;/dev/tty1&quot; ]] &#123;<br>	export PS1=&quot; --&gt; &quot;<br>&#125; else &#123;<br>	export PS1=&quot;  &quot;<br>&#125; <br>export dwm=~/Downloads/dwm-yaoccc<br>export Desktop=/mnt/Users/PC/Desktop<br>export qqmusic=/opt/apps/com.qq.music.deepin/files/run.sh<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">设置终端的语言为英文</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">export</span> LANG=en_US</span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash"><span class="hljs-built_in">alias</span>:命令别名设置</span><br>alias l=&#x27;exa --long --git&#x27;<br>alias c=clear<br>alias v=vim<br>alias nv=nvim<br>alias za=zathura<br>alias r=ranger<br>alias rm=&#x27;rm -i&#x27;<br>alias s=source<br>alias p=pwd<br>alias chrome=google-chrome-stable<br>alias xmind=/opt/XMind-2020/data/opt/XMind/XMind<br>alias telegram=telegram-desktop<br>alias tor=tor-browser<br>alias camera=kamoso<br>alias manim=/home/zpd/.local/bin/manim<br>alias clion=/opt/clion-2022.2.1/bin/clion.sh<br>alias wine=deepin-wine5<br>alias neo=neofetch<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">挂载windows</span><br>function mnt_win()&#123;<br>  sudo mount /dev/nvme0n1p3 /mnt <br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">更新pacman的镜像源</span><br>function mirrors()&#123;<br>  curl -s &quot;https://archlinux.org/mirrorlist/?country=CN&amp;protocol=https&amp;use_mirror_status=on&quot; | sed -e &#x27;s/^#Server/Server/&#x27; -e &#x27;/^#/d&#x27; | rankmirrors -n 5 - <br>&#125;<br>function udp_mir()&#123;<br>  mirrors &gt;&gt; ./mirrors_latest<br>  sudo rm -f /etc/pacman.d/mirrorlist<br>  sudo mv ./mirrors_latest /etc/pacman.d/mirrorlist<br>  cat /etc/pacman.d/mirrorlist<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">查找应用程序pid</span><br>function pid()&#123;<br><span class="hljs-meta prompt_">   # </span><span class="language-bash">program_name=$(pstree -p | grep <span class="hljs-variable">$1</span> | <span class="hljs-built_in">head</span> -1)</span><br>   program_name=$(ps -ef|grep $1)<br>   echo $&#123;program_name&#125;<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">设置软件代理,并非系统代理</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">dae+daed based</span><br>function proxyon()&#123;<br>	sudo systemctl enable --now dae<br>	daed run &gt; /dev/null 2&gt;&amp;1&amp; <br>	echo -e &quot;\nProxy ready, open http://localhost:2023 to start proxying.\nNote:Close proxy in the panel before command &#x27;proxyoff&#x27;.&quot;<br>&#125;<br>function proxyoff()&#123;<br>	sudo systemctl disable --now dae<br>	pkill dae<br>	sudo pkill daed<br>	unset http_proxy<br>	unset https_proxy<br>	unset all_proxy<br>	echo -e &quot;\nUnset http,https,all proxy, proxy off&quot;<br>&#125;<br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"></span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">外接显示屏设置</span><br><span class="hljs-meta prompt_"># </span><span class="language-bash">默认笔记本放在副屏的右边,下面这条命令可以把显示器放在屏幕的左边</span><br>function scrtoleft()&#123;<br>    xrandr --output eDP-1 --left-of HDMI-1	<br>&#125;<br></code></pre></td></tr></table></figure>
<h3 id="9-2-wezterm">9.2 wezterm</h3>
<p>个人对于 wezterm 这个终端模拟器的评价非常高，而且还跨平台，支持图片查看, 支持终端复用, 也许将来会把 linux 下的 st 换为 wezterm. 我的配置文件很简单，如下:</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><code class="hljs lua"><span class="hljs-comment">------------ Init ------------</span><br><span class="hljs-keyword">local</span> wezterm = <span class="hljs-built_in">require</span> <span class="hljs-string">&#x27;wezterm&#x27;</span><br><span class="hljs-keyword">local</span> act = wezterm.action<br><span class="hljs-keyword">local</span> <span class="hljs-built_in">config</span> = &#123;&#125;<br><span class="hljs-keyword">if</span> wezterm.config_builder <span class="hljs-keyword">then</span><br>  <span class="hljs-built_in">config</span> = wezterm.config_builder()<br><span class="hljs-keyword">end</span><br><br><br><br><span class="hljs-comment">---------- Basic windows config ------------</span><br><span class="hljs-comment">-- cli: wezterm start --position 500,200</span><br><span class="hljs-built_in">config</span>.default_cwd = <span class="hljs-string">&#x27;C:/Users/PC/Desktop/&#x27;</span><br><span class="hljs-built_in">config</span>.enable_tab_bar = <span class="hljs-literal">false</span><br><span class="hljs-built_in">config</span>.tab_bar_at_bottom = <span class="hljs-literal">true</span><br><span class="hljs-built_in">config</span>.window_decorations = <span class="hljs-string">&quot;RESIZE&quot;</span><br><span class="hljs-built_in">config</span>.window_close_confirmation = <span class="hljs-string">&#x27;NeverPrompt&#x27;</span><br><span class="hljs-built_in">config</span>.initial_cols = <span class="hljs-number">90</span><br><span class="hljs-built_in">config</span>.initial_rows = <span class="hljs-number">25</span><br><span class="hljs-built_in">config</span>.window_padding = &#123; left = <span class="hljs-number">2</span>, right = <span class="hljs-number">2</span>, top = <span class="hljs-number">0</span>, bottom = <span class="hljs-number">0</span> &#125;<br><br><br><br><span class="hljs-comment">---------- Themes config ------------</span><br><span class="hljs-comment">-- opcity and blur</span><br><span class="hljs-built_in">config</span>.window_background_opacity = <span class="hljs-number">.85</span><br><span class="hljs-comment">-- config.win32_system_backdrop = &#x27;Acrylic&#x27;</span><br><span class="hljs-built_in">config</span>.font_size = <span class="hljs-number">15</span><br><span class="hljs-comment">-- color scheme</span><br><span class="hljs-built_in">config</span>.color_scheme = <span class="hljs-string">&#x27;Dracula+&#x27;</span><br><span class="hljs-comment">-- shell</span><br><span class="hljs-built_in">config</span>.default_prog = &#123; <span class="hljs-string">&#x27;C:/Program Files/PowerShell/7/pwsh.exe&#x27;</span>, <span class="hljs-string">&#x27;-l&#x27;</span> &#125;<br><span class="hljs-comment">-- cursor</span><br><span class="hljs-built_in">config</span>.default_cursor_style = <span class="hljs-string">&quot;BlinkingBar&quot;</span><br><span class="hljs-built_in">config</span>.cursor_blink_rate = <span class="hljs-number">800</span><br><span class="hljs-built_in">config</span>.cursor_thickness = <span class="hljs-string">&quot;1px&quot;</span><br><span class="hljs-comment">-- font: WezTerm bundles JetBrains Mono, Nerd Font Symbols and Noto Color Emoji fonts and uses those for the default font configuration.</span><br><br><br><br><span class="hljs-comment">---------- Launch menu ------------</span><br><span class="hljs-built_in">config</span>.launch_menu = &#123;<br>  <span class="hljs-comment">-- cmd-&#x27;-l&#x27;:show login log</span><br>  &#123; label = <span class="hljs-string">&#x27;cmd&#x27;</span>, args = &#123;<span class="hljs-string">&#x27;cmd&#x27;</span>, <span class="hljs-string">&#x27;-l&#x27;</span>&#125;, cwd = <span class="hljs-string">&#x27;C:/Users/PC&#x27;</span> &#125;,<br>&#125;<br><br><br><br><span class="hljs-comment">---------- Key bindings ------------</span><br><span class="hljs-comment">-- Activate copy mode: Ctrl + Shift + X (vim-like copy mode)</span><br><span class="hljs-built_in">config</span>.keys = &#123;<br>  <span class="hljs-comment">-- 1.tab key bindings</span><br>  <span class="hljs-comment">-- New Tab, Close Tab</span><br>  &#123; key = <span class="hljs-string">&#x27;n&#x27;</span>,              mods = <span class="hljs-string">&#x27;CTRL&#x27;</span>,          action = act.SpawnTab <span class="hljs-string">&#x27;CurrentPaneDomain&#x27;</span>             &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;q&#x27;</span>,              mods = <span class="hljs-string">&#x27;CTRL&#x27;</span>,          action = act.CloseCurrentTab  &#123; confirm = <span class="hljs-literal">true</span> &#125;      &#125;,<br><br>  <span class="hljs-comment">-- 2. panes key bindings</span><br>  <span class="hljs-comment">-- search in cli(&#x27;CRAL+R&#x27; to cycle through &#x27;case-sensitive&#x27;, &#x27;ignoring case&#x27;, &#x27;regular&#x27;)</span><br>  &#123; key = <span class="hljs-string">&#x27;F&#x27;</span>,              mods = <span class="hljs-string">&#x27;SHIFT|CTRL&#x27;</span>,    action = act.Search&#123; CaseInSensitiveString = <span class="hljs-string">&#x27;&#x27;</span> &#125;      &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;s&#x27;</span>,              mods = <span class="hljs-string">&#x27;SHIFT|CTRL&#x27;</span>,    action = act.Search( <span class="hljs-string">&quot;CurrentSelectionOrEmptyString&quot;</span> ) &#125;,<br>  <span class="hljs-comment">-- Split Pane</span><br>  &#123; key = <span class="hljs-string">&quot;Enter&quot;</span>,          mods = <span class="hljs-string">&#x27;CTRL|SHIFT&#x27;</span>,    action = act.SplitHorizontal  &#123; domain = <span class="hljs-string">&#x27;CurrentPaneDomain&#x27;</span> &#125; &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;h&#x27;</span>,              mods = <span class="hljs-string">&#x27;CTRL|SHIFT&#x27;</span>,    action = act.SplitVertical    &#123; domain = <span class="hljs-string">&#x27;CurrentPaneDomain&#x27;</span> &#125; &#125;,<br>  <span class="hljs-comment">-- Adjust Pane</span><br>  &#123; key = <span class="hljs-string">&#x27;LeftArrow&#x27;</span>,      mods = <span class="hljs-string">&#x27;CTRL|SHIFT&#x27;</span>,    action = act.AdjustPaneSize   &#123; <span class="hljs-string">&#x27;Left&#x27;</span>,  <span class="hljs-number">2</span> &#125; &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;RightArrow&#x27;</span>,     mods = <span class="hljs-string">&#x27;CTRL|SHIFT&#x27;</span>,    action = act.AdjustPaneSize   &#123; <span class="hljs-string">&#x27;Right&#x27;</span>, <span class="hljs-number">2</span> &#125; &#125;,<br>  <span class="hljs-comment">-- Rotates panes,Swith pane </span><br>  &#123; key = <span class="hljs-string">&#x27;r&#x27;</span>,              mods = <span class="hljs-string">&#x27;ALT&#x27;</span>,           action = act.RotatePanes <span class="hljs-string">&#x27;CounterClockwise&#x27;</span>  &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;Enter&#x27;</span>,          mods = <span class="hljs-string">&#x27;ALT&#x27;</span>,           action = act.TogglePaneZoomState             &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;s&#x27;</span>,              mods = <span class="hljs-string">&#x27;ALT&#x27;</span>,           action = act.PaneSelect       &#123; alphabet = <span class="hljs-string">&#x27;1234567890&#x27;</span>, mode = <span class="hljs-string">&#x27;SwapWithActive&#x27;</span>&#125; &#125;,<br>  <span class="hljs-comment">-- Active pane</span><br>  &#123; key = <span class="hljs-string">&#x27;LeftArrow&#x27;</span>,      mods = <span class="hljs-string">&#x27;ALT&#x27;</span>,           action = act.ActivatePaneDirection <span class="hljs-string">&#x27;Left&#x27;</span>    &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;RightArrow&#x27;</span>,     mods = <span class="hljs-string">&#x27;ALT&#x27;</span>,           action = act.ActivatePaneDirection <span class="hljs-string">&#x27;Right&#x27;</span>   &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;UpArrow&#x27;</span>,        mods = <span class="hljs-string">&#x27;ALT&#x27;</span>,           action = act.ActivatePaneDirection <span class="hljs-string">&#x27;Up&#x27;</span>      &#125;,<br>  &#123; key = <span class="hljs-string">&#x27;DownArrow&#x27;</span>,      mods = <span class="hljs-string">&#x27;ALT&#x27;</span>,           action = act.ActivatePaneDirection <span class="hljs-string">&#x27;Down&#x27;</span>    &#125;,<br><br>  <span class="hljs-comment">-- 3. show launcher</span><br>  &#123; key = <span class="hljs-string">&#x27;m&#x27;</span>,              mods = <span class="hljs-string">&#x27;ALT&#x27;</span>,           action = act.ShowLauncher                    &#125;,<br>&#125;<br><br><br><br><span class="hljs-comment">---------- Mouse Config ------------</span><br><span class="hljs-built_in">config</span>.mouse_bindings = &#123;<br>  <span class="hljs-comment">-- 1. windows drag</span><br>  &#123; event = &#123; Drag = &#123; streak = <span class="hljs-number">1</span>, button = <span class="hljs-string">&#x27;Left&#x27;</span> &#125; &#125;, mods = <span class="hljs-string">&#x27;CTRL&#x27;</span>,  action = act.StartWindowDrag, &#125;,<br>  <span class="hljs-comment">-- 2. open hyper link</span><br>  &#123; event = &#123; Up =   &#123; streak = <span class="hljs-number">1</span>, button = <span class="hljs-string">&#x27;Left&#x27;</span> &#125; &#125;, mods = <span class="hljs-string">&#x27;CTRL&#x27;</span>,  action = act.OpenLinkAtMouseCursor, &#125;,<br>&#125;<br><br><br><br><span class="hljs-comment">-- return configuration to wezterm</span><br><span class="hljs-keyword">return</span> <span class="hljs-built_in">config</span> <br></code></pre></td></tr></table></figure>
<p>在 windows 上的效果如图:</p>
<p><img src="/img/archlinux_intro/wezterm_1.png" srcset="/img/loading.gif" lazyload alt="wezterm I"><br>
<img src="/img/archlinux_intro/wezterm_2.png" srcset="/img/loading.gif" lazyload alt="wezterm II"></p>
<h2 id="10-一篇文章">10 一篇文章</h2>
<p>我最近看到的一篇关于Linux的文章:<a href="https://zongpingding.github.io/2024/03/26/work_with_linux/">王垠-完全使用Linux工作</a>, 你们也可以看一看, 应该可以改变很多人对 Linux 的刻板印象.</p>

                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
    <div class="post-meta mr-3 d-flex align-items-center">
      <i class="iconfont icon-category"></i>
      

<span class="category-chains">
  
  
    
      <span class="category-chain">
        
  <a href="/categories/Linux/" class="category-chain-item">Linux</a>
  
  

      </span>
    
  
</span>

    </div>
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Computer/" class="print-no-link">#Computer</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>ArchLinux 入门</div>
      <div>https://zongpingding.github.io/2024/03/26/archlinux_intro/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>Author</div>
          <div>Eureka</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>Posted on</div>
          <div>March 26, 2024</div>
        </div>
      
      
      
        <div class="license-meta-item">
          <div>Licensed under</div>
          <div>
            
              
              
                <a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - Attribution">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2024/03/26/ascii_art/" title="ASCII Art in TeX">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">ASCII Art in TeX</span>
                        <span class="visible-mobile">Previous</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2024/03/26/calculus_of_variation/" title="calculus_of_variation">
                        <span class="hidden-mobile">calculus_of_variation</span>
                        <span class="visible-mobile">Next</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <script type="text/javascript">
    Fluid.utils.loadComments('#comments', function() {
      var light = 'github-light';
      var dark = 'github-dark';
      var schema = document.documentElement.getAttribute('data-user-color-scheme');
      if (schema === 'dark') {
        schema = dark;
      } else {
        schema = light;
      }
      window.UtterancesThemeLight = light;
      window.UtterancesThemeDark = dark;
      var s = document.createElement('script');
      s.setAttribute('src', 'https://utteranc.es/client.js');
      s.setAttribute('repo', 'zongpingding/Utterances');
      s.setAttribute('issue-term', 'pathname');
      
      s.setAttribute('label', 'comment');
      
      s.setAttribute('theme', schema);
      s.setAttribute('crossorigin', 'anonymous');
      document.getElementById('comments').appendChild(s);
    })
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>Table of Contents</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">Search</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">Keyword</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        Views: 
        <span id="busuanzi_value_site_pv"></span>
        
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        Visitors: 
        <span id="busuanzi_value_site_uv"></span>
        
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">Blog works best with JavaScript enabled</div>
  </noscript>
</body>
</html>
